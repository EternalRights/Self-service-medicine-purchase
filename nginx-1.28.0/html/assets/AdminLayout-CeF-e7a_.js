import{_ as K,z as O,u as Q,g as c,p as U,A as h,B as ee,c as se,d as s,w as o,r as t,h as oe,o as te,a,q as d,i as l,G as ae,I as R,W as ne,X as le,Y as re,Z as ue,E as m,T as de}from"./index-ukrIOK15.js";const ie={class:"admin-layout"},me={class:"header-left"},pe={class:"brand"},fe=["src"],_e={class:"header-right"},ce={class:"el-dropdown-link"},we={class:"menu-icon-wrapper"},ge=["src"],ve={__name:"AdminLayout",setup(be){const B=new URL("/assets/medicine-box-BixbYBSc.png",import.meta.url).href,w=O(),k=Q(),A=h(),D=oe(),p=c(!1),f=c(!1),g=c("营业中"),P=c(null),r=c({currentPassword:"",newPassword:"",confirmPassword:""}),E=U(()=>A.path),V=U(()=>w.businessStatus),q={currentPassword:[{required:!0,message:"请输入当前密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(u,e,v)=>{e!==r.value.newPassword?v(new Error("两次输入密码不一致")):v()},trigger:"blur"}]},L=u=>{switch(u){case"businessSetting":p.value=!0,g.value=V.value;break;case"changePassword":f.value=!0;break;case"logout":N();break;case"refreshStatus":M();break}},M=async()=>{try{await w.initBusinessStatus(),m.success("状态刷新成功")}catch(u){m.error("刷新失败: "+u.message)}},T=async()=>{try{await w.updateBusinessStatus(g.value),p.value=!1,m.success("营业状态更新成功")}catch{m.error("营业状态更新失败")}},I=async()=>{try{await P.value.validate(),await k.changePassword({currentPassword:r.value.currentPassword,newPassword:r.value.newPassword}),f.value=!1,P.value.resetFields(),m.success("密码修改成功")}catch{m.error("密码修改失败")}},N=async()=>{try{await de.confirm("确定要退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await k.logout(),D.push("/auth/admin-login")}catch{}};return ee(async()=>{try{await w.initBusinessStatus()}catch(u){console.error("初始化营业状态失败:",u)}}),(u,e)=>{const v=t("el-tag"),i=t("el-icon"),b=t("el-dropdown-item"),Y=t("el-dropdown-menu"),$=t("el-dropdown"),z=t("el-header"),_=t("el-menu-item"),G=t("el-menu"),W=t("el-aside"),X=t("router-view"),Z=t("el-main"),j=t("el-container"),C=t("el-radio"),H=t("el-radio-group"),y=t("el-button"),F=t("el-dialog"),x=t("el-input"),S=t("el-form-item"),J=t("el-form");return te(),se("div",ie,[s(z,{class:"admin-header"},{default:o(()=>[a("div",me,[a("div",pe,[a("img",{src:d(B),alt:"医药自助购",class:"brand-icon"},null,8,fe),e[8]||(e[8]=a("span",{class:"brand-name"},"医药自助购",-1)),s(v,{type:V.value==="营业中"?"success":"info",class:"status-tag"},{default:o(()=>[l(ae(V.value),1)]),_:1},8,["type"])])]),a("div",_e,[e[13]||(e[13]=a("span",{class:"admin-greeting"},"管理员，您好！",-1)),s($,{onCommand:L},{dropdown:o(()=>[s(Y,null,{default:o(()=>[s(b,{command:"businessSetting"},{default:o(()=>[...e[9]||(e[9]=[l("营业状态设置",-1)])]),_:1}),s(b,{command:"refreshStatus"},{default:o(()=>[s(i,null,{default:o(()=>[s(d(ne))]),_:1}),e[10]||(e[10]=l(" 刷新营业状态 ",-1))]),_:1}),s(b,{command:"changePassword"},{default:o(()=>[...e[11]||(e[11]=[l("修改密码",-1)])]),_:1}),s(b,{divided:"",command:"logout"},{default:o(()=>[...e[12]||(e[12]=[l("退出登录",-1)])]),_:1})]),_:1})]),default:o(()=>[a("span",ce,[s(i,null,{default:o(()=>[s(d(R))]),_:1})])]),_:1})])]),_:1}),s(j,{class:"admin-container"},{default:o(()=>[s(W,{width:"240px",class:"admin-sidebar"},{default:o(()=>[s(G,{"default-active":E.value,class:"admin-menu",router:"","background-color":"#0F1420","text-color":"#fff","active-text-color":"#165DFF"},{default:o(()=>[s(_,{index:"/admin/dashboard"},{default:o(()=>[s(i,null,{default:o(()=>[s(d(le))]),_:1}),e[14]||(e[14]=a("span",null,"仪表板",-1))]),_:1}),s(_,{index:"/admin/orders"},{default:o(()=>[s(i,null,{default:o(()=>[s(d(re))]),_:1}),e[15]||(e[15]=a("span",null,"订单管理",-1))]),_:1}),s(_,{index:"/admin/drugs"},{default:o(()=>[a("div",we,[a("img",{src:d(B),alt:"药品管理",class:"menu-icon"},null,8,ge)]),e[16]||(e[16]=a("span",null,"药品管理",-1))]),_:1}),s(_,{index:"/admin/users"},{default:o(()=>[s(i,null,{default:o(()=>[s(d(R))]),_:1}),e[17]||(e[17]=a("span",null,"用户管理",-1))]),_:1}),s(_,{index:"/admin/inventory"},{default:o(()=>[s(i,null,{default:o(()=>[s(d(ue))]),_:1}),e[18]||(e[18]=a("span",null,"进货管理",-1))]),_:1})]),_:1},8,["default-active"])]),_:1}),s(Z,{class:"admin-main"},{default:o(()=>[s(X)]),_:1})]),_:1}),s(F,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=n=>p.value=n),title:"营业状态设置",width:"400px"},{footer:o(()=>[s(y,{onClick:e[1]||(e[1]=n=>p.value=!1)},{default:o(()=>[...e[21]||(e[21]=[l("取消",-1)])]),_:1}),s(y,{type:"primary",onClick:T},{default:o(()=>[...e[22]||(e[22]=[l("确认",-1)])]),_:1})]),default:o(()=>[s(H,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=n=>g.value=n)},{default:o(()=>[s(C,{label:"营业中"},{default:o(()=>[...e[19]||(e[19]=[l("营业中",-1)])]),_:1}),s(C,{label:"暂停营业"},{default:o(()=>[...e[20]||(e[20]=[l("暂停营业",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),s(F,{modelValue:f.value,"onUpdate:modelValue":e[7]||(e[7]=n=>f.value=n),title:"修改密码",width:"400px"},{footer:o(()=>[s(y,{onClick:e[6]||(e[6]=n=>f.value=!1)},{default:o(()=>[...e[23]||(e[23]=[l("取消",-1)])]),_:1}),s(y,{type:"primary",onClick:I},{default:o(()=>[...e[24]||(e[24]=[l("确认",-1)])]),_:1})]),default:o(()=>[s(J,{model:r.value,rules:q,ref_key:"passwordFormRef",ref:P},{default:o(()=>[s(S,{label:"当前密码",prop:"currentPassword"},{default:o(()=>[s(x,{type:"password",modelValue:r.value.currentPassword,"onUpdate:modelValue":e[3]||(e[3]=n=>r.value.currentPassword=n)},null,8,["modelValue"])]),_:1}),s(S,{label:"新密码",prop:"newPassword"},{default:o(()=>[s(x,{type:"password",modelValue:r.value.newPassword,"onUpdate:modelValue":e[4]||(e[4]=n=>r.value.newPassword=n)},null,8,["modelValue"])]),_:1}),s(S,{label:"确认新密码",prop:"confirmPassword"},{default:o(()=>[s(x,{type:"password",modelValue:r.value.confirmPassword,"onUpdate:modelValue":e[5]||(e[5]=n=>r.value.confirmPassword=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Pe=K(ve,[["__scopeId","data-v-19857004"]]);export{Pe as default};
