import{_ as ee,g as i,f as ae,B as le,c as w,d as l,w as t,r as o,E as y,a5 as te,o as p,a as F,F as ne,q as E,H as oe,N as O,O as H,a6 as re,J as h,i as g,T as se}from"./index-9D8OPAh3.js";import{a as ue,d as de,b as ie}from"./users-BvkD-Ug8.js";var c=(u=>(u[u.MALE=1]="MALE",u[u.FEMALE=2]="FEMALE",u[u.OTHER=3]="OTHER",u))(c||{});const pe={class:"user-management"},me={class:"toolbar"},ge={class:"filter-section"},ce={key:3},_e={class:"pagination-container"},ve={__name:"UserManagement",setup(u){const L=[{value:c.MALE,label:"男"},{value:c.FEMALE,label:"女"},{value:c.OTHER,label:"其他"}],D=i([]),U=i(!1),s=ae({page:1,pageSize:10,total:0}),C=i(""),x=i(null),V=i([]),v=i(!1),S=i(null),r=i({id:null,name:"",phone_number:"",gender:null,age:null}),N={name:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"change"}],age:[{type:"number",min:0,max:120,message:"年龄必须在 0 到 120 之间",trigger:"blur"}]},_=async()=>{var n,e;try{U.value=!0;const b={page:s.page,pageSize:s.pageSize,keyword:C.value,gender:x.value,startDate:(n=V.value)==null?void 0:n[0],endDate:(e=V.value)==null?void 0:e[1]},d=await ue(b);D.value=d.data.items,s.total=d.data.total}catch(b){y.error("获取用户列表失败: "+b.message)}finally{U.value=!1}},f=()=>{s.page=1,_()},Y=n=>{s.pageSize=n,_()},$=n=>{s.page=n,_()},q=n=>{S.value=n,r.value={id:n.id,name:n.name,phone_number:n.phone_number,gender:n.gender,age:n.age},v.value=!0},K=async()=>{try{await ie(r.value.id,{name:r.value.name,gender:r.value.gender,age:r.value.age}),y.success("用户信息更新成功"),v.value=!1,_()}catch(n){y.error("更新用户信息失败: "+n.message)}},I=n=>{se.confirm("确定要删除该用户吗？此操作不可恢复！","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await de(n),y.success("用户删除成功"),_()}catch(e){y.error("删除用户失败: "+e.message)}}).catch(()=>{})};return le(()=>{_()}),(n,e)=>{var R;const b=o("el-icon"),d=o("el-button"),z=o("el-input"),A=o("el-option"),B=o("el-select"),P=o("el-date-picker"),T=o("el-card"),m=o("el-table-column"),M=o("el-tag"),j=o("el-table"),J=o("el-pagination"),k=o("el-form-item"),Q=o("el-input-number"),W=o("el-form"),X=o("el-dialog"),Z=te("loading");return p(),w("div",pe,[l(T,{class:"toolbar-card",shadow:"never"},{default:t(()=>[F("div",me,[F("div",ge,[l(z,{modelValue:C.value,"onUpdate:modelValue":e[0]||(e[0]=a=>C.value=a),placeholder:"搜索用户名、手机号",clearable:"",class:"search-input",onClear:f,onKeyup:ne(f,["enter"])},{append:t(()=>[l(d,{onClick:f},{default:t(()=>[l(b,null,{default:t(()=>[l(E(oe))]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(B,{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=a=>x.value=a),placeholder:"全部性别",clearable:"",onChange:f},{default:t(()=>[(p(),w(O,null,H(L,a=>l(A,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),l(P,{modelValue:V.value,"onUpdate:modelValue":e[2]||(e[2]=a=>V.value=a),type:"daterange","range-separator":"至","start-placeholder":"注册开始日期","end-placeholder":"注册结束日期","value-format":"YYYY-MM-DD",onChange:f},null,8,["modelValue"])])])]),_:1}),l(T,{class:"user-list-card",shadow:"never"},{default:t(()=>[re((p(),h(j,{data:D.value,style:{width:"100%"},"header-cell-style":{background:"#0F1420",color:"#fff"},"row-class-name":"user-table-row"},{default:t(()=>[l(m,{prop:"id",label:"ID",width:"80"}),l(m,{prop:"name",label:"用户名",width:"150"}),l(m,{prop:"phone_number",label:"手机号",width:"150"}),l(m,{label:"性别",width:"100"},{default:t(({row:a})=>[a.gender===E(c).MALE?(p(),h(M,{key:0},{default:t(()=>[...e[11]||(e[11]=[g("男",-1)])]),_:1})):a.gender===E(c).FEMALE?(p(),h(M,{key:1,type:"danger"},{default:t(()=>[...e[12]||(e[12]=[g("女",-1)])]),_:1})):a.gender===E(c).OTHER?(p(),h(M,{key:2,type:"info"},{default:t(()=>[...e[13]||(e[13]=[g("其他",-1)])]),_:1})):(p(),w("span",ce,"--"))]),_:1}),l(m,{prop:"age",label:"年龄",width:"80"}),l(m,{prop:"create_time",label:"注册时间",width:"180"}),l(m,{label:"操作",width:"180",fixed:"right"},{default:t(({row:a})=>[l(d,{type:"primary",size:"small",onClick:G=>q(a)},{default:t(()=>[...e[14]||(e[14]=[g(" 编辑 ",-1)])]),_:1},8,["onClick"]),l(d,{type:"danger",size:"small",onClick:G=>I(a.id)},{default:t(()=>[...e[15]||(e[15]=[g(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Z,U.value]]),F("div",_e,[l(J,{"current-page":s.page,"onUpdate:currentPage":e[3]||(e[3]=a=>s.page=a),"page-size":s.pageSize,"onUpdate:pageSize":e[4]||(e[4]=a=>s.pageSize=a),total:s.total,"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",background:"",onSizeChange:Y,onCurrentChange:$},null,8,["current-page","page-size","total"])])]),_:1}),l(X,{modelValue:v.value,"onUpdate:modelValue":e[10]||(e[10]=a=>v.value=a),title:`编辑用户信息 - ${(R=S.value)==null?void 0:R.name}`,width:"500px"},{footer:t(()=>[l(d,{onClick:e[9]||(e[9]=a=>v.value=!1)},{default:t(()=>[...e[16]||(e[16]=[g("取消",-1)])]),_:1}),l(d,{type:"primary",onClick:K},{default:t(()=>[...e[17]||(e[17]=[g("保存",-1)])]),_:1})]),default:t(()=>[l(W,{ref:"userFormRef",model:r.value,rules:N,"label-width":"100px"},{default:t(()=>[l(k,{label:"用户名",prop:"name"},{default:t(()=>[l(z,{modelValue:r.value.name,"onUpdate:modelValue":e[5]||(e[5]=a=>r.value.name=a)},null,8,["modelValue"])]),_:1}),l(k,{label:"手机号",prop:"phone_number"},{default:t(()=>[l(z,{modelValue:r.value.phone_number,"onUpdate:modelValue":e[6]||(e[6]=a=>r.value.phone_number=a),disabled:""},null,8,["modelValue"])]),_:1}),l(k,{label:"性别",prop:"gender"},{default:t(()=>[l(B,{modelValue:r.value.gender,"onUpdate:modelValue":e[7]||(e[7]=a=>r.value.gender=a),placeholder:"请选择性别"},{default:t(()=>[(p(),w(O,null,H(L,a=>l(A,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(k,{label:"年龄",prop:"age"},{default:t(()=>[l(Q,{modelValue:r.value.age,"onUpdate:modelValue":e[8]||(e[8]=a=>r.value.age=a),min:0,max:120},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ye=ee(ve,[["__scopeId","data-v-18de64df"]]);export{ye as default};
